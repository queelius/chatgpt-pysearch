<!DOCTYPE html><html><head>  <meta charset="utf-8"/>  <title>Chat GPT: 3D Multivariate Normal Visualization.</title>  <meta name="generator" content="chatGPT Saving Bookmark"/><style>body {  background-color: rgb(32,33,35);  color: rgb(236,236,241);  font-size: 16px;  font-family: sans-serif;  line-height: 28px;  margin: 0;}body > .w-full {  padding: 30px;}/* prompt */body > .w-full:nth-child(2n+1) {  background: rgb(52,53,65);}/* response */body > .w-full:nth-child(2n+2) {  background: rgb(68,70,84);}a, a:visited {  color: #7792cd;}pre {  margin: 0 0 1em 0;  display: inline-block;  width: 100%;}pre code.hljs {  margin-bottom: 1em;  border-radius: 5px;}.whitespace-pre-wrap {  white-space: pre-wrap;}.flex-col {  max-width: 850px;  margin: 0px auto;}*, :after, :before {    border: 0 solid #d9d9e3;    box-sizing: border-box;}table {    border-collapse: collapse;    border-color: inherit;    text-indent: 0;}.markdown table {    --tw-border-spacing-x: 0px;    --tw-border-spacing-y: 0px;    border-collapse: separate;    border-spacing: var(--tw-border-spacing-x) var(--tw-border-spacing-y);    width: 100%}.markdown th {    background-color: rgba(236,236,241,.2);    border-bottom-width: 1px;    border-left-width: 1px;    border-top-width: 1px;    padding: .25rem .75rem}.markdown th:first-child {    border-top-left-radius: .375rem}.markdown th:last-child {    border-right-width: 1px;    border-top-right-radius: .375rem}.markdown td {    border-bottom-width: 1px;    border-left-width: 1px;    padding: .25rem .75rem}.markdown td:last-child {    border-right-width: 1px}.markdown tbody tr:last-child td:first-child {    border-bottom-left-radius: .375rem}.markdown tbody tr:last-child td:last-child {    border-bottom-right-radius: .375rem}/* chatGPT code color theme */code.hljs,code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#fff;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{border-radius:.3em;overflow:auto}:not(pre)>code.hljs,:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.hljs-comment{color:hsla(0,0%,100%,.5)}.hljs-meta{color:hsla(0,0%,100%,.6)}.hljs-built_in,.hljs-class .hljs-title{color:#e9950c}.hljs-doctag,.hljs-formula,.hljs-keyword,.hljs-literal{color:#2e95d3}.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#00a67d}.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#df3079}.hljs-bullet,.hljs-link,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#f22c3d}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#a9aec1}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{background:window;color:windowText}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}/* style of the code snippets */.rounded-md {    border-radius: 0.375rem;}.mb-4 {    margin-bottom: 1rem;}.p-4 {    padding: 1rem;}.py-2 {    padding-bottom: 0.5rem;    padding-top: 0.5rem;}.px-4 {    padding-left: 1rem;    padding-right: 1rem;}.text-xs {    font-size: .75rem;    line-height: 1rem;}.bg-black {    --tw-bg-opacity: 1;    background-color: rgba(0,0,0,var(--tw-bg-opacity));}.text-gray-200 {    --tw-text-opacity: 1;    color: rgba(217,217,227,var(--tw-text-opacity));}.bg-gray-800 {    --tw-bg-opacity: 1;    background-color: rgba(52,53,65,var(--tw-bg-opacity));}.rounded-t-md {    border-top-left-radius: 0.375rem;    border-top-right-radius: 0.375rem;}code.hljs, code[class*=language-], pre[class*=language-] {    word-wrap: normal;    background: none;    color: #fff;    -webkit-hyphens: none;    hyphens: none;    line-height: 1.5;    tab-size: 4;    text-align: left;    white-space: pre;    word-break: normal;    word-spacing: normal;}.prose :where(code):not(:where([class~=not-prose] *)) {    color: var(--tw-prose-code);    font-size: .875em;    font-weight: 600;}.prose :where(pre):not(:where([class~=not-prose] *)) {    background-color: transparent;    border-radius: 0.375rem;    color: currentColor;    font-size: .875em;    font-weight: 400;    line-height: 1.7142857;    margin: 0;    overflow-x: auto;    padding: 0;}.prose :where(pre code):not(:where([class~=not-prose] *)) {    background-color: transparent;    border-radius: 0;    border-width: 0;    color: inherit;    font-family: inherit;    font-size: inherit;    font-weight: inherit;    line-height: inherit;    padding: 0;}.\!whitespace-pre {    white-space: pre!important;}.overflow-y-auto {    overflow-y: auto;}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"/></head><body><div class="flex w-full items-center justify-center gap-1 border-b border-black/10 bg-gray-50 p-3 text-gray-500 dark:border-gray-900/50 dark:bg-gray-700 dark:text-gray-300">Model: Default (GPT-3.5)</div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">I need code to visualize a 3d multivariate normal in R.</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>You can use the "rgl" package to create 3D visualizations in R. To visualize a 3D multivariate normal distribution, you can follow these steps:</p><ol><li>Install and load the required packages.</li><li>Generate multivariate normal data.</li><li>Plot the data using "rgl" functions.</li></ol><p>Here's the code:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"rgl"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"rgl"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"mvtnorm"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"mvtnorm"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>rgl<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>mvtnorm<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Generate 3D multivariate normal data</span>
n_samples <span class="hljs-operator">&lt;-</span> 1000
data <span class="hljs-operator">&lt;-</span> rmvnorm<span class="hljs-punctuation">(</span>n_samples<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create 3D scatter plot</span>
plot3d<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">"blue"</span><span class="hljs-punctuation">,</span> size <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> type <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">"3D Multivariate Normal Distribution"</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set axis labels</span>
xlab3d<span class="hljs-punctuation">(</span><span class="hljs-string">"X-axis"</span><span class="hljs-punctuation">)</span>
ylab3d<span class="hljs-punctuation">(</span><span class="hljs-string">"Y-axis"</span><span class="hljs-punctuation">)</span>
zlab3d<span class="hljs-punctuation">(</span><span class="hljs-string">"Z-axis"</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the aspect ratio to make the plot isotropic</span>
aspect3d<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span>
</code></div></div></pre><p>This code creates a 3D scatter plot of a multivariate normal distribution with a specified mean vector <code>mu</code> and covariance matrix <code>sigma</code>. You can change the mean vector and covariance matrix to match the parameters of your desired distribution.</p></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">it didn't show anything.</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>I apologize for any confusion. Here's an alternative approach using the "scatterplot3d" package to create a 3D scatter plot. Please follow these steps:</p><ol><li>Install and load the required packages.</li><li>Generate multivariate normal data.</li><li>Plot the data using "scatterplot3d" function.</li></ol><p>Here's the code:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"scatterplot3d"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"scatterplot3d"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"mvtnorm"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"mvtnorm"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>scatterplot3d<span class="hljs-punctuation">)</span>
library<span class="hljs-punctuation">(</span>mvtnorm<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Generate 3D multivariate normal data</span>
n_samples <span class="hljs-operator">&lt;-</span> 1000
data <span class="hljs-operator">&lt;-</span> rmvnorm<span class="hljs-punctuation">(</span>n_samples<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create 3D scatter plot</span>
s3d <span class="hljs-operator">&lt;-</span> scatterplot3d<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> pch <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> <span class="hljs-string">"blue"</span><span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">"3D Multivariate Normal Distribution"</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set axis labels</span>
s3d<span class="hljs-operator">$</span>xyz.convert<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>
s3d<span class="hljs-operator">$</span>xyz.label<span class="hljs-punctuation">(</span><span class="hljs-string">"X-axis"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Y-axis"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"Z-axis"</span><span class="hljs-punctuation">)</span>
</code></div></div></pre><p>This code should create a 3D scatter plot of a multivariate normal distribution with the specified mean vector <code>mu</code> and covariance matrix <code>sigma</code>. Make sure you run the code in an environment where graphics are supported, such as RStudio or a standalone R console.</p></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">Maybe countour plots?</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>You can create contour plots to visualize the probability density function (PDF) of a 3D multivariate normal distribution. In this case, you would create 2D contour plots for each pair of variables (x-y, x-z, and y-z) using the <code>MASS</code> package. Here's how you can do that:</p><ol><li>Install and load the required packages.</li><li>Define the mean vector and covariance matrix.</li><li>Create contour plots for each pair of variables.</li></ol><p>Here's the code:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>MASS<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Define a grid for the contour plots</span>
x_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
y_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
z_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a grid for each pair of variables</span>
xy_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">)</span>
xz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>
yz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the probability density function (PDF) for each grid</span>
xy_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xy_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
xz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
yz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>yz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create contour plots for each pair of variables</span>
par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> pty <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">"Contour plot (X-Y)"</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-string">"X"</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-string">"Y"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">"Contour plot (X-Z)"</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-string">"X"</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-string">"Z"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> yz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">"Contour plot (Y-Z)"</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-string">"Y"</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-string">"Z"</span><span class="hljs-punctuation">)</span>
</code></div></div></pre><p>This code creates 2D contour plots for each pair of variables (x-y, x-z, and y-z) using the specified mean vector <code>mu</code> and covariance matrix <code>sigma</code>. The contour plots display the PDF of the 3D multivariate normal distribution, which can be used to visualize the density of the distribution in two-dimensional space.</p></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">how can i show the greek symbols $\lambda_1,\lambda_2,\lambda_3$ in my axes?</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-center border-b p-3 text-gray-500 dark:border-black/20 dark:text-gray-400 text-xs">The previous model used in this conversation is unavailable. We've switched you to the latest default model</div><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>To show Greek symbols in the axis labels of a plot, you can use the <code>expression()</code> function in R. Here's how you can modify the code I provided earlier to show the Greek symbols λ1, λ2, and λ3 in the axis labels:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>MASS<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Define a grid for the contour plots</span>
x_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
y_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
z_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a grid for each pair of variables</span>
xy_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">)</span>
xz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>
yz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the probability density function (PDF) for each grid</span>
xy_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xy_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
xz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
yz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>yz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create contour plots for each pair of variables</span>
par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> pty <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> yz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></div></div></pre><p>This code uses the <code>expression()</code> function to create axis labels with Greek symbols λ1, λ2, and λ3. The axis labels are included in the <code>xlab</code> and <code>ylab</code> arguments of the <code>contour()</code> function.</p></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">how can i add a hat to them? these are estimates</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>To add a hat symbol to indicate that the symbols represent estimates of the parameters, you can modify the code I provided earlier by including the <code>hat()</code> function in the axis labels. Here's the modified code:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>MASS<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Define a grid for the contour plots</span>
x_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
y_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
z_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a grid for each pair of variables</span>
xy_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">)</span>
xz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>
yz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the probability density function (PDF) for each grid</span>
xy_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xy_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
xz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
yz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>yz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create contour plots for each pair of variables</span>
par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> pty <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> yz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
</code></div></div></pre><p>This code adds the <code>hat()</code> function to the <code>expression()</code> call in each axis label, so that the Greek symbols λ1, λ2, and λ3 are modified to indicate that they represent estimates of the parameters. The resulting axis labels display the symbols λ̂1, λ̂2, and λ̂3.</p></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">okay, now i want to save it to a graphic file</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>You can save the contour plots to a graphic file in R using the <code>pdf()</code> or <code>png()</code> function. Here's how you can modify the code I provided earlier to save the plots to a PDF file:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>MASS<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Define a grid for the contour plots</span>
x_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
y_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
z_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a grid for each pair of variables</span>
xy_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">)</span>
xz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>
yz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the probability density function (PDF) for each grid</span>
xy_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xy_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
xz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
yz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>yz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create contour plots for each pair of variables</span>
par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> pty <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> yz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Save the plots to a PDF file</span>
pdf<span class="hljs-punctuation">(</span><span class="hljs-string">"contour_plots.pdf"</span><span class="hljs-punctuation">)</span>
par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> pty <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z
</code></div></div></pre></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">contniue</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>_grid, yz_pdf, main = expression(paste("Contour plot (", hat(lambda[2]), "-", hat(lambda[3]), ")")), xlab = expression(hat(lambda[2])), ylab = expression(hat(lambda[3])))
dev.off()</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>vbnet</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-vbnet">
This code first displays the contour plots <span class="hljs-keyword">in</span> the R graphics window. <span class="hljs-keyword">Then</span>, it saves the plots <span class="hljs-keyword">to</span> a PDF file called <span class="hljs-string">"contour_plots.pdf"</span> <span class="hljs-keyword">using</span> the `pdf()` <span class="hljs-keyword">function</span> before calling the `contour()` <span class="hljs-keyword">function</span> again. <span class="hljs-keyword">Finally</span>, the `dev.<span class="hljs-keyword">off</span>()` <span class="hljs-keyword">function</span> <span class="hljs-built_in">is</span> used <span class="hljs-keyword">to</span> close the PDF file.

You can change the file extension <span class="hljs-keyword">to</span> `.png` <span class="hljs-built_in">or</span> any other supported format <span class="hljs-keyword">to</span> save the plots <span class="hljs-keyword">in</span> different file formats. Also, you can modify the path <span class="hljs-built_in">and</span> file name <span class="hljs-keyword">to</span> save the file <span class="hljs-keyword">in</span> a specific directory <span class="hljs-built_in">or</span> <span class="hljs-keyword">with</span> a different name.
</code></div></div></pre></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">i want to do png</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>Sure, here's how you can modify the code to save the contour plots as PNG files:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>MASS<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Define a grid for the contour plots</span>
x_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
y_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
z_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a grid for each pair of variables</span>
xy_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">)</span>
xz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>
yz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the probability density function (PDF) for each grid</span>
xy_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xy_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
xz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>xz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
yz_pdf <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>dmvnorm<span class="hljs-punctuation">(</span>yz_grid<span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create contour plots for each pair of variables</span>
par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> pty <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> yz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Save the plots to PNG files</span>
png<span class="hljs-punctuation">(</span><span class="hljs-string">"contour_plot_xy.png"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> y_grid<span class="hljs-punctuation">,</span> xy_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>

png<span class="hljs-punctuation">(</span><span class="hljs-string">"contour_plot_xz.png"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>x_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> xz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"-"</span><span class="hljs-punctuation">,</span> hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-string">")"</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> xlab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>hat<span class="hljs-punctuation">(</span>lambda<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
dev.off<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>

png<span class="hljs-punctuation">(</span><span class="hljs-string">"contour_plot_yz.png"</span><span class="hljs-punctuation">)</span>
contour<span class="hljs-punctuation">(</span>y_grid<span class="hljs-punctuation">,</span> z_grid<span class="hljs-punctuation">,</span> yz_pdf<span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-built_in">expression</span><span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">"Contour plot ("</span><span class="hljs-punctuation">,</span> hat
</code></div></div></pre></div></div></div><div class="flex justify-between lg:block"></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 dark:bg-gray-800"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap">now i want to visualize a prediction interval.</div></div></div></div></div><div class="group w-full text-gray-800 dark:text-gray-100 border-b border-black/10 dark:border-gray-900/50 bg-gray-50 dark:bg-[#444654]"><div class="text-base gap-4 md:gap-6 md:max-w-2xl lg:max-w-xl xl:max-w-3xl p-4 md:py-6 flex lg:px-0 m-auto"><div class="relative flex w-[calc(100%-50px)] flex-col gap-1 md:gap-3 lg:w-[calc(100%-115px)]"><div class="flex flex-grow flex-col gap-3"><div class="min-h-[20px] flex flex-col items-start gap-4 whitespace-pre-wrap"><div class="markdown prose w-full break-words dark:prose-invert dark"><p>Sure, here's an example of how to visualize a prediction interval for a 3D multivariate normal distribution:</p><pre><div class="bg-black rounded-md mb-4"><div class="flex items-center relative text-gray-200 bg-gray-800 px-4 py-2 text-xs font-sans justify-between rounded-t-md"><span>R</span></div><div class="p-4 overflow-y-auto"><code class="!whitespace-pre hljs language-R"><span class="hljs-comment"># Install required packages if you haven't already</span>
<span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span>requireNamespace<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">,</span> quietly <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">"MASS"</span><span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span>

<span class="hljs-comment"># Load required packages</span>
library<span class="hljs-punctuation">(</span>MASS<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the mean and covariance matrix for the 3D multivariate normal distribution</span>
mu <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>
sigma <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span>
                  <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> ncol <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> byrow <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Generate a random sample of size 1000 from the distribution</span>
set.seed<span class="hljs-punctuation">(</span><span class="hljs-number">123</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># for reproducibility</span>
x <span class="hljs-operator">&lt;-</span> mvrnorm<span class="hljs-punctuation">(</span>n <span class="hljs-operator">=</span> <span class="hljs-number">1000</span><span class="hljs-punctuation">,</span> mu <span class="hljs-operator">=</span> mu<span class="hljs-punctuation">,</span> Sigma <span class="hljs-operator">=</span> sigma<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the mean and covariance matrix of the sample</span>
x_bar <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span>
S <span class="hljs-operator">&lt;-</span> var<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Set the significance level and degrees of freedom for the prediction interval</span>
alpha <span class="hljs-operator">&lt;-</span> 0.05
df <span class="hljs-operator">&lt;-</span> nrow<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-operator">-</span> <span class="hljs-number">1</span>

<span class="hljs-comment"># Define a grid for the prediction interval</span>
x_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
y_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>
z_grid <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> length.out <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a grid for each pair of variables</span>
xy_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">)</span>
xz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>
yz_grid <span class="hljs-operator">&lt;-</span> expand.grid<span class="hljs-punctuation">(</span>y <span class="hljs-operator">=</span> y_grid<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z_grid<span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Compute the prediction interval for each grid</span>
xy_pi <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>xy_grid<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  t<span class="hljs-punctuation">(</span>x <span class="hljs-operator">-</span> x_bar<span class="hljs-punctuation">)</span> <span class="hljs-operator">%*%</span> solve<span class="hljs-punctuation">(</span>S<span class="hljs-punctuation">)</span> <span class="hljs-operator">%*%</span> <span class="hljs-punctuation">(</span>x <span class="hljs-operator">-</span> x_bar<span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;</span> qchisq<span class="hljs-punctuation">(</span><span class="hljs-number">1</span> <span class="hljs-operator">-</span> alpha<span class="hljs-punctuation">,</span> df<span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">)</span>
xz_pi <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>xz_grid<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  t<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">-</span> x_bar<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%*%</span> solve<span class="hljs-punctuation">(</span>S<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%*%</span> <span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">-</span> x_bar<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;</span> qchisq<span class="hljs-punctuation">(</span><span class="hljs-number">1</span> <span class="hljs-operator">-</span> alpha<span class="hljs-punctuation">,</span> df<span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">)</span>
yz_pi <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>yz_grid<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">{</span>
  t<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">-</span> x_bar<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%*%</span> solve<span class="hljs-punctuation">(</span>S<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">%*%</span> <span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">-</span> x_bar<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">&lt;</span> qchisq<span class="hljs-punctuation">(</span><span class="hljs-number">1</span> <span class="hljs-operator">-</span> alpha<span class="hljs-punctuation">,</span> df<span class="hljs-punctuation">)</span>
<span class="hljs-punctuation">}</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Create a 3D scatter plot of the sample points</span>
library<span class="hljs-punctuation">(</span>rgl<span class="hljs-punctuation">)</span>
plot3d<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> type <span class="hljs-operator">=</span> <span class="hljs-string">"s"</span><span class="hljs-punctuation">,</span> radius <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><span class="hljs-punctuation">)</span>

<span class="hljs-comment"># Add the prediction interval to the plot</span>
x_pi <span class="hljs-operator">&lt;-</span> x_grid<span class="hljs-punctuation">[</span>xy_pi<span class="hljs-punctuation">]</span>
y_pi <span class="hljs-operator">&lt;-</span> y_grid<span class="hljs-punctuation">[</span>xy_pi<span class="hljs-punctuation">]</span>
z_pi <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span>xy_pi<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
segments3d<span class="hljs-punctuation">(</span>x_pi<span class="hljs-punctuation">,</span> y_pi<span class="hljs-punctuation">,</span> z_pi<span class="hljs-punctuation">,</span> x_pi<span class="hljs-punctuation">,</span> y_pi<span class="hljs-punctuation">,</span> z_pi <span class="hljs-operator">+</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">"red"</span><span class="hljs-punctuation">,</span> lwd <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span>
x_pi <span class="hljs-operator">&lt;-</span> x_grid<span class="hljs-punctuation">[</span>xz_pi<span class="hljs-punctuation">]</span>
y_pi <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span>xz_pi<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>
z_pi <span class="hljs-operator">&lt;-</span> z_grid<span class="hljs-punctuation">[</span>xz_pi<span class="hljs-punctuation">]</span>
segments3d<span class="hljs-punctuation">(</span>x_pi<span class="hljs-punctuation">,</span> y_pi<span class="hljs-punctuation">,</span> z_pi<span class="hljs-punctuation">,</span> x_pi<span class="hljs-punctuation">,</span> y_pi <span class="hljs-operator">+</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span> z_pi<span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">"
</span></code></div></div></pre></div></div></div><div class="flex justify-between lg:block"></div></div></div></div></body></html>